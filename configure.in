dnl Process this file with autoconf to produce a configure script.
AC_INIT(dec.c)
AM_INIT_AUTOMAKE(libhsync, 0.4.1)
AM_CONFIG_HEADER(config.h)

AC_LIBTOOL_DLOPEN
AM_PROG_LIBTOOL

# compile with optimisation and without debugging by default
CFLAGS=${CFLAGS-"-O -Wall"}

AC_CANONICAL_HOST

dnl Checks for programs.
AC_PROG_CC
AC_PROG_INSTALL
AC_CHECK_PROG(PYTHON, python, python)

dnl Checks for libraries.
AC_CHECK_LIB(z, deflate)

AC_ARG_ENABLE(ccmalloc,
	[  --enable-ccmalloc       use ccmalloc debugger (default no)],
	[ CCMALLOC_LIB="-lccmalloc -ldl" ],
	[ CCMALLOC_LIB="" ])

AC_ARG_ENABLE(trace,
        [  --enable-trace          turn on library tracing],
	[ AC_DEFINE(DO_HS_TRACE) ])

dnl Checks for header files.
AC_HEADER_STDC

AC_SUBST(OBJ_SAVE)
AC_SUBST(OBJ_RESTORE)
AC_SUBST(CC_SHOBJ_FLAG)
AC_SUBST(CCMALLOC_LIB)

AC_OUTPUT(./Makefile)